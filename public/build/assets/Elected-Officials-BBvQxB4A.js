import{d as fe,r as T,C as L,c as B,o as f,a as l,u as e,m as me,w as t,b as o,e as i,f as J,g as b,h as W,F as se,i as pe,t as O,j as ce}from"./app-MIj-x2e7.js";import{_ as ge,K as y}from"./AppLayout.vue_vue_type_script_setup_true_lang-CSxpvPt3.js";import{_ as G,a as _e,b as H,c as R,d as X,e as Y,f as Z}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-Cd99ALrh.js";import{_ as U,a as D,b as F,c as I,d as A,e as N,f as m}from"./SelectValue.vue_vue_type_script_setup_true_lang-CSkcsaY4.js";import{_ as ye,a as ve,b as j,c as S,d as xe,e as v,f as we}from"./Skeleton.vue_vue_type_script_setup_true_lang-5F3gyeTa.js";import{_ as $}from"./index-CMF8biEl.js";import{_ as p}from"./Input.vue_vue_type_script_setup_true_lang-DiIXYmQY.js";import{_ as u}from"./Label.vue_vue_type_script_setup_true_lang-BLRejT2Q.js";import{u as Ve,a as be,C as Se}from"./Skeleton.vue_vue_type_script_setup_true_lang-D5xm4D-j.js";import{L as h}from"./loader-circle-Cf8XFwn6.js";import{P as $e,T as qe}from"./trash-2-B1d9aTEV.js";import"./NavFooter.vue_vue_type_script_setup_true_lang-ClUnydFW.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Y7kyMVs6.js";import"./check-B883N-7R.js";const Ce={class:"p-4 space-y-6"},Ee={class:"flex w-full justify-between items-center"},Oe={class:"grid gap-4 py-4"},Pe={class:"grid grid-cols-4 items-center gap-4"},ke={class:"grid grid-cols-4 items-center gap-4"},Me={class:"grid grid-cols-4 items-center gap-4"},Be={class:"grid grid-cols-4 items-center gap-4"},Ue={class:"grid grid-cols-4 items-center gap-4"},De={class:"grid grid-cols-4 items-center gap-4"},Fe={class:"grid grid-cols-4 items-center gap-4"},Ie={class:"grid gap-4 py-4"},Ae={class:"grid grid-cols-4 items-center gap-4"},Ne={class:"grid grid-cols-4 items-center gap-4"},je={class:"grid grid-cols-4 items-center gap-4"},ze={class:"grid grid-cols-4 items-center gap-4"},Ke={class:"grid grid-cols-4 items-center gap-4"},Qe={class:"grid grid-cols-4 items-center gap-4"},Te={class:"grid grid-cols-4 items-center gap-4"},Le={class:"text-center text-red-500 flex items-center justify-center"},Je={class:"flex items-center space-x-3"},We=["src"],Ge={class:"font-medium"},He={class:"text-gray-500"},Re={key:0,class:"text-green-500"},Xe={key:1,class:"text-red-500"},le=async(z,{quality:q=.3,type:K="image/jpeg"})=>{const C=await createImageBitmap(z),x=document.createElement("canvas");x.width=C.width,x.height=C.height;const Q=x.getContext("2d");if(!Q)throw new Error("Could not get canvas context");Q.drawImage(C,0,0);const w=await new Promise(ee=>x.toBlob(ee,K,q));if(!w)throw new Error("Image compression failed: blob is null");return new File([w],z.name,{type:w.type})},fs=fe({__name:"Elected-Officials",setup(z){const q=Ve(),K=[{title:"Elected Officials",href:"/admin/elected-officials"}],C=async()=>(await ce.post("/graphql",{query:`
    query {
      officials {
        encrypted_id
        name
        address
        position
        status
        photo
        user {
           email
        }
      }
    }
  `})).data.data,{isPending:x,error:Q,data:w,isFetching:ee}=be({queryKey:["fetchOfficials"],queryFn:C}),P=T(!1);function te(){P.value=!0}const n=L({name:"",address:"",position:"",status:"",email:"",password:"",picture:null}),ae=()=>{n.post(route("create.official"),{onSuccess:()=>{y.success("Official created successfully"),n.reset(),P.value=!1,q.invalidateQueries({queryKey:["fetchOfficials"]})},onError:()=>{y.error("Email already exists"),console.error("Error")}})},k=T(!1);function ie(c,s,a,V,d,g){r.id=c,r.name=s,r.address=a,r.position=V,r.status=d,r.email=g,k.value=!0}const r=L({id:"",name:"",address:"",position:"",status:"",email:"",password:"",picture:null}),oe=()=>{r.post(route("update.official"),{onSuccess:()=>{y.success("Official updated successfully"),r.reset(),k.value=!1,q.invalidateQueries({queryKey:["fetchOfficials"]})},onError:()=>{y.error("Email already exists"),console.error("Error")}})},M=T(!1);function re(c){E.id=c,M.value=!0}const E=L({id:""}),de=()=>{E.delete(route("delete.official"),{onSuccess:()=>{y.success("Official deleted successfully"),E.reset(),M.value=!1,q.invalidateQueries({queryKey:["fetchOfficials"]})},onError:()=>{y.error("Deletion Error"),console.error("Error")}})},ne=async c=>{var g;const s=c.target,a=(g=s.files)==null?void 0:g[0];if(!a)return;const d=2*1024*1024;if(a.type.startsWith("image"))try{a.size>d&&(s.value="",y.error("File too large. Please select a smaller file."));const _=await le(a,{quality:.3,type:a.type});n.picture=_}catch(_){console.error("Compression error:",_)}},ue=async c=>{var g;const s=c.target,a=(g=s.files)==null?void 0:g[0];if(!a)return;const d=2*1024*1024;if(a.type.startsWith("image"))try{a.size>d&&(s.value="",y.error("File too large. Please select a smaller file."));const _=await le(a,{quality:.3,type:a.type});r.picture=_}catch(_){console.error("Compression error:",_)}};return(c,s)=>(f(),B(se,null,[l(e(me),{title:"Elected Officials"}),l(ge,{breadcrumbs:K},{default:t(()=>[o("div",Ce,[o("div",Ee,[s[53]||(s[53]=o("h6",{class:"flex-1 text-md font-bold"},"Elected Officials",-1)),l(e(G),{open:P.value,"onUpdate:open":s[6]||(s[6]=a=>P.value=a)},{default:t(()=>[l(e(_e),{"as-child":""},{default:t(()=>[l(e($),{onClick:te,class:"cursor-pointer"},{default:t(()=>s[15]||(s[15]=[i(" + New ")])),_:1})]),_:1}),l(e(H),{class:"sm:max-w-[600px]"},{default:t(()=>[l(e(R),null,{default:t(()=>[l(e(X),null,{default:t(()=>s[16]||(s[16]=[i("Add Official")])),_:1}),l(e(Y),null,{default:t(()=>s[17]||(s[17]=[i(" Enter details for a new official ")])),_:1})]),_:1}),o("form",{action:"",onSubmit:J(ae,["prevent"])},[o("div",Oe,[o("div",Pe,[l(e(u),{class:"text-right"},{default:t(()=>s[18]||(s[18]=[i("Name")])),_:1}),l(e(p),{modelValue:e(n).name,"onUpdate:modelValue":s[0]||(s[0]=a=>e(n).name=a),placeholder:"John Doe",class:"col-span-3",required:""},null,8,["modelValue"])]),o("div",ke,[l(e(u),{class:"text-right"},{default:t(()=>s[19]||(s[19]=[i("Address")])),_:1}),l(e(p),{modelValue:e(n).address,"onUpdate:modelValue":s[1]||(s[1]=a=>e(n).address=a),placeholder:"Address",class:"col-span-3",required:""},null,8,["modelValue"])]),o("div",Me,[l(e(u),{class:"text-right"},{default:t(()=>s[20]||(s[20]=[i("Position")])),_:1}),l(e(U),{modelValue:e(n).position,"onUpdate:modelValue":s[2]||(s[2]=a=>e(n).position=a),class:"col-span-3",required:""},{default:t(()=>[l(e(D),{class:"w-[180px]"},{default:t(()=>[l(e(F),{placeholder:"Select a position"})]),_:1}),l(e(I),null,{default:t(()=>[l(e(A),null,{default:t(()=>[l(e(N),null,{default:t(()=>s[21]||(s[21]=[i("Positions")])),_:1}),l(e(m),{value:"Mayor"},{default:t(()=>s[22]||(s[22]=[i(" Mayor ")])),_:1}),l(e(m),{value:"Vice Mayor"},{default:t(()=>s[23]||(s[23]=[i(" Vice Mayor ")])),_:1}),l(e(m),{value:"SB Member"},{default:t(()=>s[24]||(s[24]=[i(" SB Member ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),o("div",Be,[l(e(u),{class:"text-right"},{default:t(()=>s[25]||(s[25]=[i("Status")])),_:1}),l(e(U),{modelValue:e(n).status,"onUpdate:modelValue":s[3]||(s[3]=a=>e(n).status=a),class:"col-span-3",required:""},{default:t(()=>[l(e(D),{class:"w-[180px]"},{default:t(()=>[l(e(F),{placeholder:"Select a status"})]),_:1}),l(e(I),null,{default:t(()=>[l(e(A),null,{default:t(()=>[l(e(N),null,{default:t(()=>s[26]||(s[26]=[i("Status")])),_:1}),l(e(m),{value:"1"},{default:t(()=>s[27]||(s[27]=[i(" Active ")])),_:1}),l(e(m),{value:"2"},{default:t(()=>s[28]||(s[28]=[i(" Inactive ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),o("div",Ue,[l(e(u),{class:"text-right"},{default:t(()=>s[29]||(s[29]=[i("Picture")])),_:1}),l(e(p),{type:"file",class:"col-span-3",onChange:ne,accept:"image/*",required:""})]),o("div",De,[l(e(u),{class:"text-right"},{default:t(()=>s[30]||(s[30]=[i("Email")])),_:1}),l(e(p),{modelValue:e(n).email,"onUpdate:modelValue":s[4]||(s[4]=a=>e(n).email=a),type:"email",placeholder:"john@example.com",class:"col-span-3",required:""},null,8,["modelValue"])]),o("div",Fe,[l(e(u),{class:"text-start"},{default:t(()=>s[31]||(s[31]=[i("Password")])),_:1}),l(e(p),{modelValue:e(n).password,"onUpdate:modelValue":s[5]||(s[5]=a=>e(n).password=a),placeholder:"Password",type:"password",class:"col-span-3",required:""},null,8,["modelValue"])])]),l(e(Z),null,{default:t(()=>[l(e($),{type:"submit",class:"cursor-pointer",disabled:e(n).processing},{default:t(()=>[e(n).processing?(f(),b(e(h),{key:0,class:"h-4 w-4 animate-spin"})):W("",!0),s[32]||(s[32]=i(" Save"))]),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"]),l(e(G),{open:k.value,"onUpdate:open":s[13]||(s[13]=a=>k.value=a)},{default:t(()=>[l(e(H),{class:"sm:max-w-[600px]"},{default:t(()=>[l(e(R),null,{default:t(()=>[l(e(X),null,{default:t(()=>s[33]||(s[33]=[i("Edit Official")])),_:1}),l(e(Y),null,{default:t(()=>s[34]||(s[34]=[i(" Update the details of the official ")])),_:1})]),_:1}),o("form",{action:"",onSubmit:J(oe,["prevent"])},[o("div",Ie,[o("div",Ae,[l(e(u),{class:"text-right"},{default:t(()=>s[35]||(s[35]=[i("Name")])),_:1}),l(e(p),{modelValue:e(r).name,"onUpdate:modelValue":s[7]||(s[7]=a=>e(r).name=a),placeholder:"John Doe",class:"col-span-3",required:""},null,8,["modelValue"])]),o("div",Ne,[l(e(u),{class:"text-right"},{default:t(()=>s[36]||(s[36]=[i("Address")])),_:1}),l(e(p),{modelValue:e(r).address,"onUpdate:modelValue":s[8]||(s[8]=a=>e(r).address=a),placeholder:"Address",class:"col-span-3",required:""},null,8,["modelValue"])]),o("div",je,[l(e(u),{class:"text-right"},{default:t(()=>s[37]||(s[37]=[i("Position")])),_:1}),l(e(U),{modelValue:e(r).position,"onUpdate:modelValue":s[9]||(s[9]=a=>e(r).position=a),class:"col-span-3",required:""},{default:t(()=>[l(e(D),{class:"w-[180px]"},{default:t(()=>[l(e(F),{placeholder:"Select a position"})]),_:1}),l(e(I),null,{default:t(()=>[l(e(A),null,{default:t(()=>[l(e(N),null,{default:t(()=>s[38]||(s[38]=[i("Positions")])),_:1}),l(e(m),{value:"Mayor"},{default:t(()=>s[39]||(s[39]=[i(" Mayor ")])),_:1}),l(e(m),{value:"Vice Mayor"},{default:t(()=>s[40]||(s[40]=[i(" Vice Mayor ")])),_:1}),l(e(m),{value:"SB Member"},{default:t(()=>s[41]||(s[41]=[i(" SB Member ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),o("div",ze,[l(e(u),{class:"text-right"},{default:t(()=>s[42]||(s[42]=[i("Status")])),_:1}),l(e(U),{modelValue:e(r).status,"onUpdate:modelValue":s[10]||(s[10]=a=>e(r).status=a),class:"col-span-3",required:""},{default:t(()=>[l(e(D),{class:"w-[180px]"},{default:t(()=>[l(e(F),{placeholder:"Select a status"})]),_:1}),l(e(I),null,{default:t(()=>[l(e(A),null,{default:t(()=>[l(e(N),null,{default:t(()=>s[43]||(s[43]=[i("Status")])),_:1}),l(e(m),{value:"1"},{default:t(()=>s[44]||(s[44]=[i(" Active ")])),_:1}),l(e(m),{value:"2"},{default:t(()=>s[45]||(s[45]=[i(" Inactive ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),o("div",Ke,[l(e(u),{class:"text-left"},{default:t(()=>s[46]||(s[46]=[i("Change Picture")])),_:1}),l(e(p),{type:"file",class:"col-span-3",onChange:ue,accept:"image/*"})]),o("div",Qe,[l(e(u),{class:"text-right"},{default:t(()=>s[47]||(s[47]=[i("Email")])),_:1}),l(e(p),{modelValue:e(r).email,"onUpdate:modelValue":s[11]||(s[11]=a=>e(r).email=a),type:"email",placeholder:"john@example.com",class:"col-span-3",required:""},null,8,["modelValue"])]),o("div",Te,[l(e(u),{class:"text-start"},{default:t(()=>s[48]||(s[48]=[i("Change Password")])),_:1}),l(e(p),{modelValue:e(r).password,"onUpdate:modelValue":s[12]||(s[12]=a=>e(r).password=a),placeholder:"Password",type:"password",class:"col-span-3"},null,8,["modelValue"])])]),l(e(Z),null,{default:t(()=>[l(e($),{type:"submit",class:"cursor-pointer",disabled:e(r).processing},{default:t(()=>[e(r).processing?(f(),b(e(h),{key:0,class:"h-4 w-4 animate-spin"})):W("",!0),s[49]||(s[49]=i(" Save"))]),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"]),l(e(G),{open:M.value,"onUpdate:open":s[14]||(s[14]=a=>M.value=a)},{default:t(()=>[l(e(H),{class:"sm:max-w-[600px]"},{default:t(()=>[l(e(R),null,{default:t(()=>[l(e(X),null,{default:t(()=>s[50]||(s[50]=[i("Delete Official")])),_:1}),l(e(Y),null,{default:t(()=>s[51]||(s[51]=[i(" Are you sure you want to delete this official? This action cannot be undone. ")])),_:1})]),_:1}),o("form",{action:"",onSubmit:J(de,["prevent"])},[l(e(Z),null,{default:t(()=>[l(e($),{type:"submit",class:"cursor-pointer",variant:"destructive",disabled:e(E).processing},{default:t(()=>[e(E).processing?(f(),b(e(h),{key:0,class:"h-4 w-4 animate-spin"})):W("",!0),s[52]||(s[52]=i(" Delete"))]),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"])]),l(e(ye),null,{default:t(()=>[l(e(ve),null,{default:t(()=>[l(e(j),null,{default:t(()=>[l(e(S),{class:"w-[50px]"},{default:t(()=>s[54]||(s[54]=[o("small",null,"#",-1)])),_:1}),l(e(S),{class:"w-[300px]"},{default:t(()=>s[55]||(s[55]=[o("small",null,"Name",-1)])),_:1}),l(e(S),null,{default:t(()=>s[56]||(s[56]=[o("small",null,"Position",-1)])),_:1}),l(e(S),null,{default:t(()=>s[57]||(s[57]=[o("small",null,"Address",-1)])),_:1}),l(e(S),{class:"text-right"},{default:t(()=>s[58]||(s[58]=[o("small",null,"Status",-1)])),_:1}),l(e(S),{class:"text-right"},{default:t(()=>s[59]||(s[59]=[o("small",null,"Actions",-1)])),_:1})]),_:1})]),_:1}),l(e(xe),null,{default:t(()=>{var a,V;return[e(x)?(f(),b(e(j),{key:0},{default:t(()=>[l(e(v),{colspan:"10",class:"text-center"},{default:t(()=>[l(we)]),_:1})]),_:1})):((a=e(w))==null?void 0:a.officials.length)===0?(f(),b(e(j),{key:1},{default:t(()=>[l(e(v),{colspan:"10"},{default:t(()=>[o("small",Le,[l(e(Se),{class:"mr-2 w-5"}),s[60]||(s[60]=i(" No Data Found "))])]),_:1})]),_:1})):(f(!0),B(se,{key:2},pe((V=e(w))==null?void 0:V.officials,(d,g)=>(f(),b(e(j),{key:d.id},{default:t(()=>[l(e(v),null,{default:t(()=>[o("small",null,O(g+1),1)]),_:2},1024),l(e(v),{class:"w-[300px] pr-20"},{default:t(()=>[o("div",Je,[o("img",{draggable:"false",src:"/storage/profile/"+d.photo,alt:"Profile",class:"w-10 h-10 rounded-full object-cover"},null,8,We),o("div",null,[o("div",Ge,O(d.name),1),o("small",He,O(d.user.email),1)])])]),_:2},1024),l(e(v),null,{default:t(()=>[i(O(d.position),1)]),_:2},1024),l(e(v),null,{default:t(()=>[i(O(d.address),1)]),_:2},1024),l(e(v),{class:"text-right"},{default:t(()=>[d.status==1?(f(),B("span",Re,"Active")):(f(),B("span",Xe,"Inactive"))]),_:2},1024),l(e(v),{class:"text-right"},{default:t(()=>[l(e($),{variant:"link",onClick:_=>ie(d.encrypted_id,d.name,d.address,d.position,d.status,d.user.email),class:"ml-2 cursor-pointer"},{default:t(()=>[l(e($e))]),_:2},1032,["onClick"]),l(e($),{variant:"destructive",onClick:_=>re(d.encrypted_id),class:"ml-2 cursor-pointer"},{default:t(()=>[l(e(qe))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]}),_:1})]),_:1})])]),_:1})],64))}});export{fs as default};
